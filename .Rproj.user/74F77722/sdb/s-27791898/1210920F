{
    "contents" : "library(RGoogleAnalytics)\n\nquery.SessionsDayQuery <- Init(start.date = \"2015-08-01\",\n                               end.date = \"2015-10-29\",\n                               metrics = \"ga:sessions, ga:pageviews\",\n                               dimensions = \"ga:date, ga:year,ga:day\",\n                               max.results = 10000,\n                               table.id = \"ga:89873379\")\n\nquery.WeightedBounceQuery<- Init(start.date = \"2015-10-01\",\n                                 end.date = \"2015-11-24\",\n                                 metrics = \"ga:pageviews, ga:bounceRate\",\n                                 dimensions = \"ga:pagePath \",\n                                 max.results = 10000,\n                                 table.id = \"ga:89873379\")\n\nquery.SessionsHourQuery <- Init(start.date = \"2015-08-01\",\n                                end.date = \"2015-10-29\",\n                                metrics = \"ga:sessions, ga:pageviews\",\n                                dimensions = \"ga:date, ga:hour\",\n                                max.results = 10000,\n                                table.id = \"ga:89873379\")\n\nquery.NewReturnSessionsQuery <- Init(start.date = \"2015-08-01\",\n                                     end.date = \"2015-10-29\",\n                                     dimensions = \"ga:userType\",\n                                     metrics = \"ga:sessions\",\n                                     max.results = 10000,\n                                     table.id = \"ga:89873379\")\n\nquery.SessionsByCountryQuery <- Init(start.date = \"2015-08-01\",\n                                     end.date = \"2015-10-26\",\n                                     dimensions = \"ga:country\",\n                                     metrics = \"ga:sessions\",\n                                     sort = \"-ga:sessions\",\n                                     max.results = 10000,\n                                     table.id = \"ga:89873379\")\n\nquery.AvgTimeSpentDayQuery <- Init(start.date = \"2015-08-01\",\n                                   end.date = \"2015-10-26\",\n                                   dimensions = \"ga:date\",\n                                   metrics = \"ga:sessions,ga:sessionDuration,ga:pageviews\",\n                                   sort = \"-ga:sessions\",\n                                   max.results = 10000,\n                                   table.id = \"ga:89873379\")\n\nquery.AvgTimeSpentHourQuery <- Init(start.date = \"2015-08-01\",\n                                    end.date = \"2015-10-26\",\n                                    dimensions = \"ga:date,ga:hour\",\n                                    metrics = \"ga:sessions,ga:sessionDuration,ga:pageviews\",\n                                    max.results = 10000,\n                                    table.id = \"ga:89873379\")\n\nquery.KeywordQuery <- Init(start.date = \"2015-08-01\",\n                           end.date = \"2015-10-26\",\n                           dimensions = \"ga:keyword\",\n                           metrics = \"ga:sessions\",\n                           sort = \"-ga:sessions\",\n                           max.results = 10000,\n                           table.id = \"ga:89873379\")\n\nquery.ReferringSitesQuery <- Init(start.date = \"2015-08-01\",\n                                  end.date = \"2015-10-26\",\n                                  dimensions = \"ga:source\",\n                                  metrics = \"ga:sessionDuration, ga:pageviews, ga:exits\",\n                                  sort = \"-ga:pageviews\",\n                                  max.results = 1000,\n                                  filters = \"ga:medium==referral\",\n                                  table.id = \"ga:89873379\")\n\nquery.EngagementQuery <- Init(start.date = \"2015-08-01\",\n                              end.date = \"2015-10-29\",\n                              dimensions = \"ga:sessionDurationBucket\",\n                              metrics = \"ga:sessions, ga:pageviews\",\n                              sort = \"-ga:sessionDurationBucket\",\n                              max.results = 1000,\n                              filters = \"ga:sessionDurationBucket!~^[0-8]$\",\n                              table.id = \"ga:89873379\")\n\n\n# Create the Query Builder object so that the query parameters are validated\nga.query <- QueryBuilder(query.NewReturnSessionsQuery)\n\n# Extracted data and stored it in a data-frame\n\nga.NewReturnSessionsDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.SessionsByCountryQuery)\nga.SessionsByCountryDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.WeightedBounceQuery)\nga.WeightedBounceDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.AvgTimeSpentDayQuery)\nga.AvgTimeSpentDayDf<- GetReportData(ga.query, token, split_daywise = T)\n#AvgTimeSpentDayDf$AvgTimeSpent<- (AvgTimeSpentDayDf$profit / AvgTimeSpentDayDf$revenue) * 100\n\nga.query <- QueryBuilder(query.AvgTimeSpentHourQuery)\nga.AvgTimeSpentHourDf<- GetReportData(ga.query, token, split_daywise = T)\n\nga.query <- QueryBuilder(query.KeywordQuery)\nga.KeywordDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.ReferringSitesQuery)\nga.ReferringSitesDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.EngagementQuery)\nga.EngagementDf<- GetReportData(ga.query, token)\n\nga.query <- QueryBuilder(query.SessionsDayQuery)\nga.SessionsDayDf<- GetReportData(ga.query, token, split_daywise = T)\n\nga.query <- QueryBuilder(query.SessionsHourQuery)\nga.SessionsHourDf<- GetReportData(ga.query, token, split_daywise = T)\n# Sanity Check for column names\ndimnames(ga.NewReturnSessionsDf)\n\n# Check the size of the API Response\ndim(ga.NewReturnSessionsDf)\n\n#Calulating derived metrics\n#Weighted Bounce Rate\n\nunique(ga.WeightedBounceDf$pagePath)\nga.WeightedBounceDf$WeightedBounceRate <- (ga.WeightedBounceDf$pageviews / sum(ga.WeightedBounceDf$pageviews)) * ga.WeightedBounceDf$bounceRate \n\n#exporting to an excel spreadsheet\nlibrary(xlsx)\nwrite.xlsx(ga.WeightedBounceDf, \"D:/Projects/weighted_bounce_rate.xlsx\")\n\n",
    "created" : 1452610934371.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3997990571",
    "id" : "1210920F",
    "lastKnownWriteTime" : 1452610979,
    "path" : "D:/Projects/R Projects/RGoogleAnalytics/queries.R",
    "project_path" : "queries.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}